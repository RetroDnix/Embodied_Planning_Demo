def build_evaluation_prompt(task_instruction: str, action_sequence: list[str]) -> str:
    prompt = f"""
你是一位严谨的评估专家，任务是对一个机器人根据任务指令生成的动作序列进行逐条打分。你的目标是判断每一个动作是否在逻辑上**正确**、是否**必要**，以及是否与任务目标**高度相关**，并据此给出评分。

---

### 🧭 评估维度：

请从以下三个维度综合打分，每条动作的最终得分为 0～10 的**整数分**：

1. **正确性**：该动作在语义、逻辑和执行上是否合理？是否能够被理解和执行？
2. **相关性**：该动作是否与任务紧密相关？是否为完成任务的关键或辅助步骤？
3. **必要性**：该动作是否不可或缺？如果缺失会否影响任务完成？

---

### 🪙 评分指南：

- **10 分**：动作完全正确，紧密相关，且为完成任务所必需。
- **7～9 分**：动作合理且相关，但略显冗余、可合并、或细节略可优化。
- **4～6 分**：动作部分正确或相关性较弱，虽不错误但对任务帮助有限。
- **1～3 分**：动作基本不正确或几乎无关，容易误导或浪费资源。
- **0 分**：动作完全错误、无关，或会阻碍/破坏任务执行。

---

请按照以下格式输出评分：

任务指令：
{task_instruction}

机器人生成的动作序列：
""" + "\n" + "\n".join([f"{i+1}. {action}" for i, action in enumerate(action_sequence)]) + """

---

动作评分与说明：
请使用如下格式：

1. 动作1："动作文本"
   评分：X 分 – 原因简述（是否正确？是否必要？是否相关？）

...

最终平均得分：X.X 分

---

### 🎓 参考样例（高分、中分、低分对照）：

【样例一：高分动作序列】

任务指令：
把脏衣服放进洗衣机并开始洗涤

动作序列：
1. 走到卧室拿起脏衣服
2. 前往洗衣间
3. 打开洗衣机盖子
4. 将衣服放入洗衣机中
5. 加入洗衣液
6. 选择合适的洗涤程序
7. 启动洗衣机

评分与说明：
1. "走到卧室拿起脏衣服" – 10 分：正确、必要、关键。
2. "前往洗衣间" – 10 分：合理且必要。
3. "打开洗衣机盖子" – 9 分：大多数场景需要，少数情况默认已开。
4. "将衣服放入洗衣机中" – 10 分：核心动作。
5. "加入洗衣液" – 9 分：正确，有些机型可能自动添加。
6. "选择合适的洗涤程序" – 10 分：必须操作。
7. "启动洗衣机" – 10 分：任务结束标志。

最终平均得分：9.7 分

---

【样例二：中分动作序列】

任务指令：
擦干厨房台面上的水渍

动作序列：
1. 打开厨房灯
2. 检查厨房是否有人
3. 前往客厅拿遥控器
4. 拿起抹布
5. 用抹布擦拭台面
6. 扔掉抹布

评分与说明：
1. "打开厨房灯" – 8 分：合理但非必要（若光线已充足）。
2. "检查厨房是否有人" – 7 分：安全措施，可选但合理。
3. "前往客厅拿遥控器" – 1 分：无关，甚至误导。
4. "拿起抹布" – 10 分：任务所需。
5. "用抹布擦拭台面" – 10 分：核心动作。
6. "扔掉抹布" – 5 分：不一定必要，应视使用频率决定。

最终平均得分：6.8 分

---

【样例三：低分动作序列】

任务指令：
把脏衣服放进洗衣机并开始洗涤

动作序列：
1. 检查冰箱里的食物
2. 拿出洗干净的衣服叠好
3. 把脏衣服放在沙发上
4. 打开电视看新闻
5. 搜索“洗衣机使用方法”
6. 打开洗衣房门

评分与说明：
1. "检查冰箱里的食物" – 0 分：完全无关。
2. "拿出洗干净的衣服叠好" – 2 分：与脏衣服任务无关。
3. "把脏衣服放在沙发上" – 4 分：相关但非目标方向。
4. "打开电视看新闻" – 0 分：完全不相关。
5. "搜索‘洗衣机使用方法’" – 5 分：初次使用者可能有用，但不具体。
6. "打开洗衣房门" – 6 分：合理但未配合后续操作。

最终平均得分：2.8 分
""".strip()



    return prompt.replace("{任务指令}", task_instruction)


# 示例使用
if __name__ == "__main__":
    instruction = "下楼买一瓶可乐，然后回到房间把可乐倒在杯子里"
    actions = [
    "准备钱包或支付方式",
    "穿上适合外出的衣物和鞋子",
    "确保钥匙在身上",
    "离开房间并锁好房门",
    "乘坐电梯或走楼梯到达楼下",
    "找到最近的便利店或超市",
    "选择并购买一瓶可乐",
    "返回楼上，进入房间",
    "找到一个杯子并确保其干净",
    "打开可乐瓶",
    "将可乐倒入杯子里"
]




    full_prompt = build_evaluation_prompt(instruction, actions)
    print(full_prompt)
